{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport _axios from '@/axios/myaxios';\nconst options = {\n  data() {\n    return {\n      rules: {\n        courseName: [{\n          required: true,\n          message: '请输入活动名称',\n          trigger: 'blur'\n        }],\n        desc: [{\n          required: true,\n          message: '请输入活动名称',\n          trigger: 'blur'\n        }],\n        type\n      },\n      defaultProps: {\n        children: 'children',\n        label: 'label'\n      },\n      teachPlanList: [{\n        label: \"第一章\",\n        children: [{\n          label: \"第一小节\"\n        }, {\n          label: \"第二小节\"\n        }, {\n          label: \"第三小节\"\n        }]\n      }, {\n        label: \"第二章\",\n        children: [{\n          label: \"第一小节\"\n        }]\n      }],\n      coverUrl: \"\",\n      courseBaseInfo: {},\n      active: 1,\n      schoolName: \"\",\n      courseType: '',\n      schoolList: [\"清华大学\", \"北京大学\"],\n      courseTypeList: [{\n        value: 2,\n        label: '研究生课'\n      }, {\n        value: 3,\n        label: '职业教育'\n      }, {\n        value: 4,\n        label: '计算机'\n      }, {\n        value: 5,\n        label: '经济管理'\n      }, {\n        value: 6,\n        label: '文史哲'\n      }, {\n        value: 7,\n        label: '医药卫生'\n      }, {\n        value: 8,\n        label: '外语'\n      }, {\n        value: 9,\n        label: '工学'\n      }, {\n        value: 10,\n        label: '理学'\n      }, {\n        value: 11,\n        label: '艺术设计'\n      }, {\n        value: 15,\n        label: '营销'\n      }, {\n        value: 16,\n        label: '财务'\n      }, {\n        value: 17,\n        label: '农林园艺'\n      }]\n    };\n  },\n  methods: {\n    removeCoverUrl(file, fileList) {\n      var params = new URLSearchParams();\n      params.append(\"coverUrl\", this.coverUrl);\n      _axios.delete(\"/images/delete?\" + params).then(resp => {\n        if (resp.data.code !== 1) {\n          this.$message({\n            message: '删除失败',\n            type: 'error'\n          });\n          return false;\n        } else {\n          this.coverUrl = \"\";\n        }\n      });\n    },\n    handleAvatarSuccess(res) {\n      this.coverUrl = res.data;\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg';\n      const isLt2M = file.size / 1024 / 1024 < 10;\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 10MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    last() {\n      if (this.active-- < 0) this.active = 0;\n    },\n    next() {\n      this.courseBaseInfo.coverUrl = this.coverUrl;\n      _axios.put(\"/course/add\", this.courseBaseInfo).then(resp => {\n        if (resp.data.code == 1) {\n          this.courseBaseInfo = resp.data.data;\n          if (this.active++ > 3) this.active = 0;\n        }\n      });\n    }\n  },\n  mounted() {},\n  beforeDestroy() {\n    if (this.coverUrl) {\n      this.removeCoverUrl(null, null);\n    }\n  }\n};\nexport default options;","map":{"version":3,"names":["_axios","options","data","rules","courseName","required","message","trigger","desc","type","defaultProps","children","label","teachPlanList","coverUrl","courseBaseInfo","active","schoolName","courseType","schoolList","courseTypeList","value","methods","removeCoverUrl","file","fileList","params","URLSearchParams","append","delete","then","resp","code","$message","handleAvatarSuccess","res","beforeAvatarUpload","isJPG","isLt2M","size","error","last","next","put","mounted","beforeDestroy"],"sources":["src/views/AddCourseView.vue"],"sourcesContent":["<template>\r\n    <div data-v-1b10f526 class=\"workspace\">\r\n        <div data-v-1b10f526 class=\"banner\">\r\n            <span data-v-1b10f526 class=\"primary-title\">课程-修改</span>\r\n        </div>\r\n        <div data-v-1b10f526 class=\"steps\">\r\n            <div data-v-1b10f526 class=\"nav\">\r\n                <el-steps :active=\"active\" simple>\r\n                    <el-step title=\"基本信息\">\r\n                    </el-step>\r\n                    <el-step title=\"课程大纲\"></el-step>\r\n                    <el-step title=\"开课时间\"></el-step>\r\n                    <el-step title=\"教导老师\"></el-step>\r\n                </el-steps>\r\n            </div>\r\n            <div data-v-1b10f526 class=\"body\">\r\n                <div data-v-1b10f526 data-v-2411f0f0 v-show=\"active ===0\" class=\"step-body\" >\r\n                    <el-form data-v-2411f0f0 :rules=\"rules\" label-width=\"80px\" :model=\"courseBaseInfo\">\r\n                        <el-form-item prop=\"courseName\" data-v-2411f0f0 label=\"课程名称\">\r\n                            <el-input style=\"width: 680px;\" placeholder=\"请输入课程名称\"\r\n                                v-model=\"courseBaseInfo.title\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"desc\" data-v-2411f0f0 label=\"课程简介\">\r\n                            <el-input style=\"width: 680px;\" type=\"textarea\" :rows=\"4\" placeholder=\"请输入课程简介\"\r\n                                v-model=\"courseBaseInfo.descr\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item data-v-2411f0f0 label=\"课程封面\">\r\n                            <el-upload class=\"avatar-uploader\" action=\"api/images/upload\" name=\"image\" \r\n                                list-type=\"picture\" :on-success=\"handleAvatarSuccess\" :limit=\"1\"\r\n                                :before-upload=\"beforeAvatarUpload\" :on-remove=\"removeCoverUrl\" >\r\n                                <img v-if=\"coverUrl\" :src=\"coverUrl\" class=\"avatar\">\r\n                                <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                            </el-upload>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"type\" data-v-2411f0f0 label=\"课程类型\">\r\n                            <el-select clearable v-model=\"courseBaseInfo.status\" placeholder=\"请选择课程类型\">\r\n                                <el-option v-for=\"item in courseTypeList\" :key=\"item.value\" :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"school\" data-v-2411f0f0 label=\"所属学校\">\r\n                            <el-select clearable v-model=\"courseBaseInfo.schoolName\" placeholder=\"请选择学校\">\r\n                                <el-option v-for=\"item in schoolList\" :key=\"item\" :label=\"item\" :value=\"item\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </div>\r\n                <div data-v-b4e21218 data-v-1b10f526 v-show=\"active === 1\" class=\"step-body\">\r\n                    <div data-v-b4e21218 class=\"bar\">\r\n                        <div data-v-b4e21218 class=\"title\">任务总数：4</div>\r\n                        <el-button size=\"medium\">+&nbsp;添加章节</el-button>\r\n                    </div>\r\n                    <div data-v-b4e21218 class=\"outline\">\r\n                        <el-tree data-v-b4e21218 :data=\"teachPlanList\" :props=\"defaultProps\" >\r\n                            <div data-v-b4e21218 class=\"tree-node\" :class=\"{ischild : !data.children}\" slot-scope=\"{node,data}\">\r\n                                <i data-v-b4e21218 class=\"icon\"></i>\r\n                                <div data-v-b4e21218 class=\"operate\">\r\n                                    <div data-v-b4e21218 class=\"title\">\r\n                                        <span data-v-b4e21218>{{ node.label }}</span>\r\n                                    </div>\r\n                                    <div data-v-b4e21218  v-if=\"!data.children\" class=\"media-file\">\r\n                                        <el-link>\r\n                                            <i class=\"el-icon-delete\"></i>\r\n                                            <span>1.jpg</span>\r\n                                        </el-link>\r\n                                    </div>\r\n                                    <div data-v-b4e21218 class=\"buttons\">\r\n                                        <el-button type=\"text\" @click=\"() => append(data)\">添加小节</el-button>\r\n                                        <el-button type=\"text\" @click=\"() => append(data)\">删除</el-button>\r\n                                        <el-button type=\"text\">上移</el-button>\r\n                                        <el-button type=\"text\">下移</el-button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </el-tree>\r\n                    </div>\r\n                </div>\r\n                <div data-v-1b10f526 v-show=\"active === 2\" class=\"step-body\"></div>\r\n            </div>\r\n            <div data-v-1b10f526 class=\"footer\">\r\n                <el-button v-show=\"active > 0\" @click=\"last()\">上一步</el-button>\r\n                <el-button type=\"primary\" @click=\"next()\">保存并进行下一步</el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport _axios from '@/axios/myaxios';\r\n\r\nconst options = {\r\n    data () {\r\n        return {\r\n            rules: {\r\n                courseName: [\r\n                    { required: true, message: '请输入活动名称', trigger: 'blur' },\r\n                ],\r\n                desc: [\r\n                    { required: true, message: '请输入活动名称', trigger: 'blur' },\r\n                ],\r\n                type\r\n            },\r\n            defaultProps: {\r\n                children: 'children',\r\n                label: 'label'\r\n            },\r\n            teachPlanList:[{\r\n                label:\"第一章\",\r\n                children:[\r\n                    {\r\n                        label:\"第一小节\"\r\n                    },{\r\n                        label:\"第二小节\"\r\n                    },{\r\n                        label:\"第三小节\"\r\n                    }\r\n\r\n                ]\r\n            },{\r\n                label:\"第二章\",\r\n                children:[\r\n                    {\r\n                        label:\"第一小节\"\r\n                    }\r\n                ]\r\n            }\r\n            ],\r\n            coverUrl:\"\",\r\n            courseBaseInfo:{},\r\n            active: 1,\r\n            schoolName:\"\",\r\n            courseType: '',\r\n            schoolList:[\r\n                \"清华大学\",\"北京大学\"\r\n            ],\r\n            courseTypeList: [\r\n                {value: 2,label: '研究生课'},\r\n                {value: 3,label: '职业教育'},{value: 4,label: '计算机'},\r\n                {value: 5,label: '经济管理'},{value: 6,label: '文史哲'},\r\n                {value: 7,label: '医药卫生'},{value: 8,label: '外语'},\r\n                {value: 9,label: '工学'},{value: 10,label: '理学'},\r\n                {value: 11, label: '艺术设计' },{value: 15,label: '营销'},\r\n                {value: 16,label: '财务'},{value: 17,label: '农林园艺'},\r\n            ],\r\n        }\r\n    },\r\n    methods: {\r\n        \r\n        removeCoverUrl(file, fileList){\r\n            var params = new URLSearchParams\r\n            params.append(\"coverUrl\",this.coverUrl)\r\n            _axios.delete(\"/images/delete?\"+params).then(resp => {\r\n                if(resp.data.code !==1){\r\n                    this.$message({\r\n                        message: '删除失败',\r\n                        type: 'error'\r\n                    });\r\n                    return false;\r\n                }else{\r\n                    this.coverUrl = \"\"\r\n                }\r\n            })\r\n        },\r\n        handleAvatarSuccess(res){\r\n            this.coverUrl = res.data\r\n        },\r\n        beforeAvatarUpload(file) {\r\n            const isJPG = file.type === 'image/jpeg';\r\n            const isLt2M = file.size / 1024 / 1024 < 10\r\n            if (!isJPG) {\r\n                this.$message.error('上传头像图片只能是 JPG 格式!');\r\n            }\r\n            if (!isLt2M) {\r\n                this.$message.error('上传头像图片大小不能超过 10MB!');\r\n            }\r\n            return isJPG && isLt2M;\r\n        },\r\n        last(){\r\n            if (this.active-- < 0) this.active = 0;\r\n        },\r\n        next() {\r\n            this.courseBaseInfo.coverUrl = this.coverUrl\r\n            _axios.put(\"/course/add\",this.courseBaseInfo).then(resp => {\r\n                if(resp.data.code == 1){\r\n                    this.courseBaseInfo = resp.data.data\r\n                    if (this.active++ > 3) this.active = 0;\r\n                }\r\n            })\r\n            \r\n        },\r\n\r\n    },\r\n    mounted() {\r\n        \r\n    },\r\n    beforeDestroy() {\r\n        if (this.coverUrl) {\r\n            this.removeCoverUrl(null, null);\r\n        }\r\n    }\r\n}\r\nexport default options;\r\n</script>\r\n<style>\r\n.el-tree-node__children .el-tree-node{\r\n    height: 80px;\r\n}\r\n\r\n.workspace .el-textarea textarea{\r\n    resize: none;\r\n}\r\n.workspace .el-form-item__label{\r\n    text-align: center;\r\n}\r\n.workspace .el-step__title.is-process{\r\n    color: #003153;\r\n}\r\n/* .workspace .el-step__title.is-finish {\r\n    color: #441752;\r\n}\r\n */\r\n .avatar-uploader .el-upload {\r\n    border: 1px dashed #7ba57b;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n    border-color: #409EFF;\r\n }\r\n .outline .el-tree-node__content{\r\n    height: 60px;\r\n}\r\n.el-tree-node__content>.el-tree-node__expand-icon{\r\n    display: none;\r\n}\r\n.step-body .outline .tree-node.ischild[data-v-b4e21218] {\r\n    border-left: 1px solid #cacaca;\r\n    padding-top: 25px;\r\n    /* margin-bottom: 25px; */\r\n    height: 80px;\r\n    line-height: 80px;\r\n}\r\n.step-body .outline .tree-node[data-v-b4e21218] {\r\n    height: 50px;\r\n    line-height: 50px;\r\n    width: 100%;\r\n}\r\n.step-body .outline .tree-node .operate[data-v-b4e21218] {\r\n    position: relative;\r\n    float: left;\r\n    padding-left: 10px;\r\n    background-color: #f1f1f1;\r\n    width: 1093px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .tree-node .operate .title[data-v-b4e21218] {\r\n    float: left;\r\n    padding-right: 10px;\r\n    width: 400px;\r\n    overflow: hidden;\r\n}\r\n.step-body .outline .tree-node .operate .buttons[data-v-b4e21218] {\r\n    position: absolute;\r\n    top: 0px;\r\n    right: 10px;\r\n    text-align: right;\r\n    width: 300px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .ischild .icon[data-v-b4e21218] {\r\n    display: block;\r\n    float: left;\r\n    width: 34px;\r\n    height: 25px;\r\n    border-bottom: 1px solid #cacaca;\r\n}\r\n.step-body .outline .tree-node[data-v-b4e21218] {\r\n    height: 50px;\r\n    line-height: 50px;\r\n    width: 100%;\r\n}\r\n.step-body .outline .ischild.tree-node .operate[data-v-b4e21218] {\r\n    width: 1040px;\r\n}\r\n\r\n.step-body .outline .tree-node .operate[data-v-b4e21218] {\r\n    position: relative;\r\n    float: left;\r\n    padding-left: 10px;\r\n    background-color: #f1f1f1;\r\n    width: 1093px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .ischild .operate .title[data-v-b4e21218] {\r\n    width: 300px;\r\n}\r\n\r\n\r\n\r\n</style>\r\n<style scoped>\r\n\r\n\r\n\r\n\r\n.avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 178px;\r\n    height: 178px;\r\n    line-height: 178px;\r\n    text-align: center;\r\n}\r\n.avatar {\r\n    width: 178px;\r\n    height: 178px;\r\n    display: block;\r\n}\r\n.avatar-uploader-icon[data-v-1affb897]{\r\n    background-color: #eaeddf;\r\n}\r\n\r\n\r\n.workspace {\r\n    margin-top: 16px;\r\n    width: 1200px;\r\n    min-height: 550px;\r\n    padding: 32px;\r\n    background-color: #e7f2eea4;\r\n}\r\n.workspace .primary-title {\r\n    height: 33px;\r\n    font-size: 24px;\r\n    font-family: PingFangSC-Medium, PingFang SC;\r\n    font-weight: 500;\r\n    color: #003153;\r\n    line-height: 33px;\r\n}\r\n.steps[data-v-1b10f526] {\r\n    padding: 20px;\r\n}\r\n.steps .nav[data-v-1b10f526] {\r\n    padding-bottom: 20px;\r\n}\r\n.steps .body[data-v-1b10f526] {\r\n    padding: 30px 0px 50px 0px;\r\n}\r\n.step-body[data-v-2411f0f0] {\r\n    width: 800px;\r\n    margin: 0px auto;\r\n}\r\n.steps .footer[data-v-1b10f526] {\r\n    padding: 20px 0px 20px 0px;\r\n    border-top: 1px solid #848ea0;\r\n    text-align: center;\r\n}\r\n.step-body .bar .title[data-v-b4e21218] {\r\n    display: inline-block;\r\n    width: 100px;\r\n    height: 22px;\r\n    font-size: 16px;\r\n    font-family: PingFangSC-Regular, PingFang SC;\r\n    font-weight: 400;\r\n    color: #003153;\r\n    line-height: 22px;\r\n}\r\n.step-body .outline[data-v-b4e21218] {\r\n    padding-top: 20px;\r\n    padding-bottom: 20px;\r\n    width: 1100px;\r\n}\r\n\r\n</style>"],"mappings":";;;AA0FA,OAAAA,MAAA;AAEA,MAAAC,OAAA;EACAC,KAAA;IACA;MACAC,KAAA;QACAC,UAAA,GACA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAC,IAAA,GACA;UAAAH,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAE;MACA;MACAC,YAAA;QACAC,QAAA;QACAC,KAAA;MACA;MACAC,aAAA;QACAD,KAAA;QACAD,QAAA,GACA;UACAC,KAAA;QACA;UACAA,KAAA;QACA;UACAA,KAAA;QACA;MAGA;QACAA,KAAA;QACAD,QAAA,GACA;UACAC,KAAA;QACA;MAEA,EACA;MACAE,QAAA;MACAC,cAAA;MACAC,MAAA;MACAC,UAAA;MACAC,UAAA;MACAC,UAAA,GACA,eACA;MACAC,cAAA,GACA;QAAAC,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA,GACA;QAAAS,KAAA;QAAAT,KAAA;MAAA;QAAAS,KAAA;QAAAT,KAAA;MAAA;IAEA;EACA;EACAU,OAAA;IAEAC,eAAAC,IAAA,EAAAC,QAAA;MACA,IAAAC,MAAA,OAAAC,eAAA;MACAD,MAAA,CAAAE,MAAA,kBAAAd,QAAA;MACAd,MAAA,CAAA6B,MAAA,qBAAAH,MAAA,EAAAI,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAA7B,IAAA,CAAA8B,IAAA;UACA,KAAAC,QAAA;YACA3B,OAAA;YACAG,IAAA;UACA;UACA;QACA;UACA,KAAAK,QAAA;QACA;MACA;IACA;IACAoB,oBAAAC,GAAA;MACA,KAAArB,QAAA,GAAAqB,GAAA,CAAAjC,IAAA;IACA;IACAkC,mBAAAZ,IAAA;MACA,MAAAa,KAAA,GAAAb,IAAA,CAAAf,IAAA;MACA,MAAA6B,MAAA,GAAAd,IAAA,CAAAe,IAAA;MACA,KAAAF,KAAA;QACA,KAAAJ,QAAA,CAAAO,KAAA;MACA;MACA,KAAAF,MAAA;QACA,KAAAL,QAAA,CAAAO,KAAA;MACA;MACA,OAAAH,KAAA,IAAAC,MAAA;IACA;IACAG,KAAA;MACA,SAAAzB,MAAA,aAAAA,MAAA;IACA;IACA0B,KAAA;MACA,KAAA3B,cAAA,CAAAD,QAAA,QAAAA,QAAA;MACAd,MAAA,CAAA2C,GAAA,qBAAA5B,cAAA,EAAAe,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAA7B,IAAA,CAAA8B,IAAA;UACA,KAAAjB,cAAA,GAAAgB,IAAA,CAAA7B,IAAA,CAAAA,IAAA;UACA,SAAAc,MAAA,aAAAA,MAAA;QACA;MACA;IAEA;EAEA;EACA4B,QAAA,GAEA;EACAC,cAAA;IACA,SAAA/B,QAAA;MACA,KAAAS,cAAA;IACA;EACA;AACA;AACA,eAAAtB,OAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}