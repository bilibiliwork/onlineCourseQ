{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport _axios from '@/axios/myaxios';\nconst options = {\n  data() {\n    return {\n      showCourseTime: false,\n      courseTime: {},\n      courseTimeList: [],\n      rules: {\n        title: [{\n          required: true,\n          message: '请输入课程',\n          trigger: 'blur'\n        }],\n        descr: [{\n          required: true,\n          message: '请输入简介',\n          trigger: 'blur'\n        }],\n        status: [{\n          required: true,\n          message: '请选择类型',\n          trigger: 'change'\n        }],\n        schoolName: [{\n          required: true,\n          message: '请选择学校',\n          trigger: 'change'\n        }]\n      },\n      expandList: [],\n      defaultProps: {\n        children: 'teachPlanTreeNodes',\n        label: 'name'\n      },\n      teachPlanList: [],\n      showInput: [],\n      coverUrl: \"\",\n      courseBaseInfo: {},\n      active: 3,\n      schoolName: \"\",\n      courseType: '',\n      courseId: 0,\n      schoolList: [\"清华大学\", \"北京大学\"],\n      courseTypeList: [{\n        value: 2,\n        label: '研究生课'\n      }, {\n        value: 3,\n        label: '职业教育'\n      }, {\n        value: 4,\n        label: '计算机'\n      }, {\n        value: 5,\n        label: '经济管理'\n      }, {\n        value: 6,\n        label: '文史哲'\n      }, {\n        value: 7,\n        label: '医药卫生'\n      }, {\n        value: 8,\n        label: '外语'\n      }, {\n        value: 9,\n        label: '工学'\n      }, {\n        value: 10,\n        label: '理学'\n      }, {\n        value: 11,\n        label: '艺术设计'\n      }, {\n        value: 15,\n        label: '营销'\n      }, {\n        value: 16,\n        label: '财务'\n      }, {\n        value: 17,\n        label: '农林园艺'\n      }]\n    };\n  },\n  methods: {\n    clearCourseTime() {\n      this.courseTime = {};\n    },\n    changeShow(id) {\n      this.showInput = [];\n      this.$set(this.showInput, id, true);\n    },\n    closeInput(data) {\n      this.$set(this.showInput, data.id, false);\n      _axios.post(\"/teachplan/updateName\", data);\n    },\n    addChapter() {\n      _axios.put(\"/teachplan/addChapter/\" + this.courseBaseInfo.id).then(resp => {\n        this.teachPlanList.push(resp.data.data);\n      });\n    },\n    append(data) {\n      _axios.put(\"/teachplan/add\", data).then(resp => {\n        if (resp.data.code === 1) {\n          if (!data.teachPlanTreeNodes) {\n            this.$set(data, 'teachPlanTreeNodes', []);\n          }\n          var list = resp.data.data;\n          list.teachplanMediaList = [];\n          list.discussList = [];\n          data.teachPlanTreeNodes.push(resp.data.data);\n          this.expandList[0] = data.id;\n          this.expandList[0] = JSON.parse(JSON.stringify(this.expandList[0]));\n        }\n      });\n    },\n    remove(node, data) {\n      _axios.delete(\"/teachplan/remove/\" + data.id).then(resp => {\n        if (resp.data.code === 1) {\n          this.expandList[0] = data.parentid;\n          this.teachPlanList = this.teachPlanList.filter(item => item.id !== data.id);\n          const removeTeachPlanFromTree = tree => {\n            return tree.filter(nodes => {\n              if (nodes.id === data.id) {\n                return false; // 删除当前节点\n              }\n              /* if (node.commentVoTrees?.length) {\r\n                  // 递归处理子节点\r\n                  node.commentVoTrees = removeCommentFromTree(node.commentVoTrees);\r\n              } */\n              return true;\n            });\n          };\n          // 遍历所有主评论，清理其嵌套树\n          this.teachPlanList = this.teachPlanList.map(item => {\n            if (item.teachPlanTreeNodes?.length) {\n              item.teachPlanTreeNodes = removeTeachPlanFromTree(item.teachPlanTreeNodes);\n            }\n            return item;\n          });\n        }\n      });\n    },\n    getTeachPlanList() {\n      _axios.get(\"/course/teachPlanList/\" + this.courseBaseInfo.id).then(resp => {\n        this.teachPlanList = resp.data.data;\n      });\n    },\n    removeCoverUrl(file, fileList) {\n      var params = new URLSearchParams();\n      params.append(\"coverUrl\", this.coverUrl);\n      _axios.delete(\"/images/delete?\" + params).then(resp => {\n        if (resp.data.code !== 1) {\n          this.$message({\n            message: '删除失败',\n            type: 'error'\n          });\n          return false;\n        } else {\n          this.coverUrl = \"\";\n        }\n      });\n    },\n    handleAvatarSuccess(res) {\n      this.coverUrl = res.data;\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg';\n      const isLt2M = file.size / 1024 / 1024 < 10;\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 10MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    last() {\n      if (this.active-- < 0) this.active = 0;\n    },\n    addCourseTime() {\n      this.courseTime.cid = this.courseBaseInfo.id;\n      this.showCourseTime = false;\n      _axios.put(\"/course-time/add\", this.courseTime).then(resp => {\n        if (resp.data.code == 1) {\n          this.courseTimeList.push(resp.data.data);\n        }\n      });\n    },\n    getCourseTimeList() {\n      _axios.get(\"/course-time/\" + this.courseBaseInfo.id).then(resp => {\n        this.courseTimeList = resp.data.data;\n      });\n    },\n    upNode(node, data) {\n      const parent = node.parent;\n      const children = parent.data.teachPlanTreeNodes || this.teachPlanList;\n      const index = children.findIndex(d => d.id === data.id);\n      if (index != 0) {\n        const tree1 = children[index - 1];\n        const tree2 = children[index];\n        this.$set(children, index - 1, tree2);\n        this.$set(children, index, tree1);\n        this.teachPlanList = JSON.parse(JSON.stringify(this.teachPlanList));\n        this.expandList[0] = data.parentid;\n        _axios.put(\"/teachplan/up\", data);\n      } else {\n        this.$message('已无法上移');\n      }\n    },\n    downNode(node, data) {\n      const parent = node.parent;\n      const children = parent.data.teachPlanTreeNodes || this.teachPlanList;\n      const index = children.findIndex(d => d.id === data.id);\n      if (index < children.length - 1) {\n        const tree1 = children[index];\n        const tree2 = children[index + 1];\n        this.$set(children, index, tree2);\n        this.$set(children, index + 1, tree1);\n        this.teachPlanList = JSON.parse(JSON.stringify(this.teachPlanList));\n        this.expandList[0] = data.parentid;\n        _axios.put(\"/teachplan/down\", data);\n      } else {\n        this.$message('已无法下移');\n      }\n    },\n    getCourse() {\n      _axios.get(\"/course/\" + this.courseId).then(resp => {\n        this.courseBaseInfo = resp.data.data;\n        this.coverUrl = this.courseBaseInfo.coverUrl;\n      });\n    },\n    next(courseBaseInfo) {\n      this.$refs[courseBaseInfo].validate(valid => {\n        if (valid) {\n          this.courseBaseInfo.coverUrl = this.coverUrl;\n          _axios.put(\"/course/add\", this.courseBaseInfo).then(resp => {\n            if (resp.data.code == 1) {\n              this.courseBaseInfo = resp.data.data;\n              if (this.active++ > 3) this.active = 0;\n              this.getTeachPlanList();\n              this.getCourseTimeList();\n            } else {\n              this.$message.error(resp.data.msg);\n            }\n          });\n        } else {\n          this.$message.error('表单验证失败');\n          return false;\n        }\n      });\n    }\n  },\n  mounted() {\n    if (this.$route.params.cid != 0) {\n      this.courseId = this.$route.params.cid;\n      this.getCourse();\n    }\n  },\n  beforeDestroy() {\n    if (this.coverUrl) {\n      this.removeCoverUrl(null, null);\n    }\n  }\n};\nexport default options;","map":{"version":3,"names":["_axios","options","data","showCourseTime","courseTime","courseTimeList","rules","title","required","message","trigger","descr","status","schoolName","expandList","defaultProps","children","label","teachPlanList","showInput","coverUrl","courseBaseInfo","active","courseType","courseId","schoolList","courseTypeList","value","methods","clearCourseTime","changeShow","id","$set","closeInput","post","addChapter","put","then","resp","push","append","code","teachPlanTreeNodes","list","teachplanMediaList","discussList","JSON","parse","stringify","remove","node","delete","parentid","filter","item","removeTeachPlanFromTree","tree","nodes","map","length","getTeachPlanList","get","removeCoverUrl","file","fileList","params","URLSearchParams","$message","type","handleAvatarSuccess","res","beforeAvatarUpload","isJPG","isLt2M","size","error","last","addCourseTime","cid","getCourseTimeList","upNode","parent","index","findIndex","d","tree1","tree2","downNode","getCourse","next","$refs","validate","valid","msg","mounted","$route","beforeDestroy"],"sources":["src/views/AddCourseView.vue"],"sourcesContent":["<template>\r\n    <div data-v-1b10f526 class=\"workspace\">\r\n        <div data-v-1b10f526 class=\"banner\">\r\n            <span data-v-1b10f526 class=\"primary-title\">课程-修改</span>\r\n        </div>\r\n        <div data-v-1b10f526 class=\"steps\">\r\n            <div data-v-1b10f526 class=\"nav\">\r\n                <el-steps :active=\"active\" simple>\r\n                    <el-step title=\"基本信息\">\r\n                    </el-step>\r\n                    <el-step title=\"课程大纲\"></el-step>\r\n                    <el-step title=\"开课时间\"></el-step>\r\n                    <el-step title=\"教导老师\"></el-step>\r\n                </el-steps>\r\n            </div>\r\n            <div data-v-1b10f526 class=\"body\">\r\n                <div data-v-1b10f526 data-v-2411f0f0 v-show=\"active ===0\" class=\"step-body\">\r\n                    <el-form data-v-2411f0f0 :rules=\"rules\" ref=\"courseBaseInfo\" label-width=\"80px\"\r\n                        :model=\"courseBaseInfo\">\r\n                        <el-form-item prop=\"title\" data-v-2411f0f0 label=\"课程名称\">\r\n                            <el-input style=\"width: 680px;\" placeholder=\"请输入课程名称\"\r\n                                v-model=\"courseBaseInfo.title\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"descr\" data-v-2411f0f0 label=\"课程简介\">\r\n                            <el-input style=\"width: 680px;\" type=\"textarea\" :rows=\"4\" placeholder=\"请输入课程简介\"\r\n                                v-model=\"courseBaseInfo.descr\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item data-v-2411f0f0 label=\"课程封面\">\r\n                            <el-upload class=\"avatar-uploader\" action=\"api/images/upload\" name=\"image\"\r\n                                list-type=\"picture\" :on-success=\"handleAvatarSuccess\" :limit=\"1\"\r\n                                :before-upload=\"beforeAvatarUpload\" :on-remove=\"removeCoverUrl\">\r\n                                <img v-if=\"coverUrl\" :src=\"coverUrl\" class=\"avatar\">\r\n                                <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                            </el-upload>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"status\" data-v-2411f0f0 label=\"课程类型\">\r\n                            <el-select clearable v-model=\"courseBaseInfo.status\" placeholder=\"请选择课程类型\">\r\n                                <el-option v-for=\"item in courseTypeList\" :key=\"item.value\" :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"schoolName\" data-v-2411f0f0 label=\"所属学校\">\r\n                            <el-select clearable v-model=\"courseBaseInfo.schoolName\" placeholder=\"请选择学校\">\r\n                                <el-option v-for=\"item in schoolList\" :key=\"item\" :label=\"item\" :value=\"item\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </div>\r\n                <div data-v-b4e21218 data-v-1b10f526 v-show=\"active === 1\" class=\"step-body\">\r\n                    <div data-v-b4e21218 class=\"bar\">\r\n                        <div data-v-b4e21218 class=\"title\">任务总数：4</div>\r\n                        <el-button size=\"medium\" @click=\"addChapter()\">+&nbsp;添加章节</el-button>\r\n                    </div>\r\n                    <div data-v-b4e21218 class=\"outline\">\r\n                        <el-tree :expand-on-click-node=\"false\" data-v-b4e21218 :default-expanded-keys=\"expandList\"\r\n                            :data=\"teachPlanList\" :props=\"defaultProps\" node-key=\"id\">\r\n                            <div data-v-b4e21218 class=\"tree-node\" :class=\"{ischild : data.grande !=1 }\"\r\n                                slot-scope=\"{node,data}\">\r\n                                <i data-v-b4e21218 v-if=\"data.grande ==1\" class=\"icon\"></i>\r\n                                <div data-v-b4e21218 class=\"operate\">\r\n                                    <div data-v-b4e21218 class=\"title\" @click=\"changeShow(data.id)\">\r\n                                        <span data-v-b4e21218 v-if=\"!showInput[data.id]\">{{ data.name }}</span>\r\n                                        <input v-else @blur=\"closeInput(data)\" v-model=\"data.name\"\r\n                                            style=\"width: 280px;height: 30px;\">\r\n                                    </div>\r\n                                    <div data-v-b4e21218 v-if=\" data.teachplanMediaList.length != 0\" class=\"media-file\">\r\n                                        <el-link>\r\n                                            <i class=\"el-icon-delete\"></i>\r\n                                            <span>1.jpg</span>\r\n                                        </el-link>\r\n                                    </div>\r\n                                    <div data-v-b4e21218 class=\"buttons\">\r\n                                        <el-button v-if=\"data.grande == 1\" type=\"text\"\r\n                                            @click=\"append(data)\">添加小节</el-button>\r\n                                        <el-button type=\"text\" @click=\"remove(node,data)\">删除</el-button>\r\n                                        <el-button type=\"text\" @click=\"upNode(node,data)\">上移</el-button>\r\n                                        <el-button type=\"text\" @click=\"downNode(node,data)\">下移</el-button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </el-tree>\r\n                    </div>\r\n                </div>\r\n                <div data-v-1b10f526 v-show=\"active === 2\" class=\"step-body\">\r\n                    <div data-v-b4e21218 class=\"bar\">\r\n                        <el-button size=\"medium\" @click=\"showCourseTime = true\"\r\n                            style=\"margin-bottom: 20px;\">+&nbsp;添加课程时间</el-button>\r\n                        <el-dialog @close=\"clearCourseTime()\" title=\"课程时间\" :visible.sync=\"showCourseTime\" width=\"500px\">\r\n                            <el-form label-width=\"80px\" size=\"medium\">\r\n                                <el-form-item label=\"开课时间\">\r\n                                    <el-date-picker value-format=\"yyyy-MM-dd HH:mm:ss\" v-model=\"courseTime.startTime\"\r\n                                        type=\"date\" placeholder=\"选择日期\">\r\n                                    </el-date-picker>\r\n                                </el-form-item>\r\n                                <el-form-item label=\"截止时间\">\r\n                                    <el-date-picker value-format=\"yyyy-MM-dd HH:mm:ss\" v-model=\"courseTime.endTime\"\r\n                                        type=\"date\" placeholder=\"选择日期\">\r\n                                    </el-date-picker>\r\n                                </el-form-item>\r\n                            </el-form>\r\n                            <div slot=\"footer\" class=\"dialog-footer\">\r\n                                <el-button @click=\"showCourseTime = false\">取 消</el-button>\r\n                                <el-button type=\"primary\" @click=\"addCourseTime()\">确 定</el-button>\r\n                            </div>\r\n                        </el-dialog>\r\n                        <el-table data-v-38e7a12e class=\"dataList\" :data=\"courseTimeList\" border style=\"width: 100%\">\r\n                            <el-table-column align=\"center\" prop=\"vagueTime\" label=\"开课季度\">\r\n                            </el-table-column>\r\n                            <el-table-column align=\"center\" prop=\"startTime\" label=\"开课时间\">\r\n                            </el-table-column>\r\n                            <el-table-column align=\"center\" prop=\"endTime\" label=\"结课时间\">\r\n                            </el-table-column>\r\n                        </el-table>\r\n                    </div>\r\n                </div>\r\n                <div data-v-1b10f526 v-show=\"active === 3\" class=\"step-body\">\r\n                    <el-table data-v-38e7a12e class=\"dataList\" :data=\"courseTimeList\" border style=\"width: 100%\">\r\n                        <el-table-column align=\"center\" prop=\"vagueTime\" label=\"开课季度\">\r\n                        </el-table-column>\r\n                        <el-table-column align=\"center\" prop=\"startTime\" label=\"开课时间\">\r\n                        </el-table-column>\r\n                        <el-table-column align=\"center\" prop=\"endTime\" label=\"结课时间\">\r\n                        </el-table-column>\r\n                        <el-table-column align=\"center\" prop=\"endTime\" label=\"结课时间\">\r\n                        </el-table-column>\r\n                    </el-table>\r\n                </div>\r\n            </div>\r\n            <div data-v-1b10f526 class=\"footer\">\r\n                <el-button v-show=\"active > 0\" @click=\"last()\">上一步</el-button>\r\n                <el-button type=\"primary\" @click=\"next('courseBaseInfo')\">保存并进行下一步</el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport _axios from '@/axios/myaxios';\r\n\r\nconst options = {\r\n    data () {\r\n        return {\r\n            showCourseTime:false,\r\n            courseTime:{\r\n            },\r\n            courseTimeList:[],\r\n            rules: {\r\n                title: [\r\n                    { required: true, message: '请输入课程', trigger: 'blur' },\r\n                ],\r\n                descr: [\r\n                    { required: true, message: '请输入简介', trigger: 'blur' },\r\n                ],\r\n                status: [\r\n                    { required: true, message: '请选择类型', trigger: 'change' },\r\n                ],\r\n                schoolName: [\r\n                    { required: true, message: '请选择学校', trigger: 'change' },\r\n                ],\r\n            },\r\n            expandList:[],\r\n            defaultProps: {\r\n                children: 'teachPlanTreeNodes',\r\n                label: 'name'\r\n            },\r\n            teachPlanList:[\r\n            ],\r\n            showInput:[],\r\n            coverUrl:\"\",\r\n            courseBaseInfo:{},\r\n            active: 3,\r\n            schoolName:\"\",\r\n            courseType: '',\r\n            courseId:0,\r\n            schoolList:[\r\n                \"清华大学\",\"北京大学\"\r\n            ],\r\n            courseTypeList: [\r\n                {value: 2,label: '研究生课'},\r\n                {value: 3,label: '职业教育'},{value: 4,label: '计算机'},\r\n                {value: 5,label: '经济管理'},{value: 6,label: '文史哲'},\r\n                {value: 7,label: '医药卫生'},{value: 8,label: '外语'},\r\n                {value: 9,label: '工学'},{value: 10,label: '理学'},\r\n                {value: 11, label: '艺术设计' },{value: 15,label: '营销'},\r\n                {value: 16,label: '财务'},{value: 17,label: '农林园艺'},\r\n            ],\r\n        }\r\n    },\r\n    methods: {\r\n        clearCourseTime(){\r\n            this.courseTime = {}\r\n        },\r\n        changeShow(id){\r\n            this.showInput = []\r\n            this.$set(this.showInput,id,true);\r\n        },\r\n        closeInput(data){\r\n            this.$set(this.showInput,data.id,false);\r\n            _axios.post(\"/teachplan/updateName\",data)\r\n        },\r\n        addChapter(){\r\n            _axios.put(\"/teachplan/addChapter/\"+this.courseBaseInfo.id).then(resp => {\r\n                this.teachPlanList.push(resp.data.data)\r\n            })\r\n        },\r\n        append(data){\r\n            _axios.put(\"/teachplan/add\", data).then(resp => {\r\n                if (resp.data.code === 1) {\r\n                    if (!data.teachPlanTreeNodes) {\r\n                        this.$set(data, 'teachPlanTreeNodes', []);\r\n                    }\r\n                    var list = resp.data.data\r\n                    list.teachplanMediaList = []\r\n                    list.discussList = []\r\n                    data.teachPlanTreeNodes.push(resp.data.data);\r\n                    this.expandList[0] = data.id\r\n                    this.expandList[0] = JSON.parse(JSON.stringify(this.expandList[0]))\r\n                }\r\n            })\r\n        },\r\n        remove(node,data){\r\n            _axios.delete(\"/teachplan/remove/\"+data.id).then(resp => {\r\n                if(resp.data.code === 1){\r\n                    this.expandList[0] = data.parentid\r\n                    this.teachPlanList = this.teachPlanList.filter(item => item.id !== data.id)\r\n                    const removeTeachPlanFromTree = (tree) => {\r\n                        return tree.filter(nodes => {\r\n                            if (nodes.id === data.id) {\r\n                                return false; // 删除当前节点\r\n                            }\r\n                            /* if (node.commentVoTrees?.length) {\r\n                                // 递归处理子节点\r\n                                node.commentVoTrees = removeCommentFromTree(node.commentVoTrees);\r\n                            } */\r\n                            return true;\r\n                        });\r\n                    };\r\n                    // 遍历所有主评论，清理其嵌套树\r\n                    this.teachPlanList = this.teachPlanList.map(item => {\r\n                        if (item.teachPlanTreeNodes?.length) {\r\n                            item.teachPlanTreeNodes = removeTeachPlanFromTree(item.teachPlanTreeNodes);\r\n                        }\r\n                        return item;\r\n                    });\r\n                }\r\n            })\r\n        },\r\n        getTeachPlanList(){\r\n            _axios.get(\"/course/teachPlanList/\"+this.courseBaseInfo.id).then(resp => {\r\n                this.teachPlanList = resp.data.data\r\n            })\r\n        },\r\n        removeCoverUrl(file, fileList){\r\n            var params = new URLSearchParams\r\n            params.append(\"coverUrl\",this.coverUrl)\r\n            _axios.delete(\"/images/delete?\"+params).then(resp => {\r\n                if(resp.data.code !==1){\r\n                    this.$message({\r\n                        message: '删除失败',\r\n                        type: 'error'\r\n                    });\r\n                    return false;\r\n                }else{\r\n                    this.coverUrl = \"\"\r\n                }\r\n            })\r\n        },\r\n        handleAvatarSuccess(res){\r\n            this.coverUrl = res.data\r\n        },\r\n        beforeAvatarUpload(file) {\r\n            const isJPG = file.type === 'image/jpeg';\r\n            const isLt2M = file.size / 1024 / 1024 < 10\r\n            if (!isJPG) {\r\n                this.$message.error('上传头像图片只能是 JPG 格式!');\r\n            }\r\n            if (!isLt2M) {\r\n                this.$message.error('上传头像图片大小不能超过 10MB!');\r\n            }\r\n            return isJPG && isLt2M;\r\n        },\r\n        last(){\r\n            if (this.active-- < 0) this.active = 0;\r\n        },\r\n        addCourseTime(){\r\n\r\n            this.courseTime.cid = this.courseBaseInfo.id\r\n            this.showCourseTime = false\r\n            _axios.put(\"/course-time/add\",this.courseTime).then(resp => {\r\n                if(resp.data.code == 1){\r\n                    this.courseTimeList.push(resp.data.data)\r\n\r\n                }\r\n            })\r\n        },\r\n        getCourseTimeList(){\r\n            _axios.get(\"/course-time/\"+this.courseBaseInfo.id).then(resp => {\r\n                this.courseTimeList = resp.data.data\r\n            })\r\n        },\r\n        upNode(node,data){\r\n            const parent = node.parent\r\n            const children = parent.data.teachPlanTreeNodes || this.teachPlanList;\r\n            const index = children.findIndex(d => d.id === data.id);\r\n            if(index != 0){\r\n                const tree1 = children[index-1]\r\n                const tree2 = children[index]\r\n                this.$set(children,index-1,tree2)\r\n                this.$set(children,index,tree1)\r\n                this.teachPlanList = JSON.parse(JSON.stringify(this.teachPlanList))\r\n                this.expandList[0] = data.parentid\r\n                _axios.put(\"/teachplan/up\",data)\r\n            }else{\r\n                this.$message('已无法上移');\r\n            }\r\n        },\r\n        downNode(node,data){\r\n            const parent = node.parent\r\n            const children = parent.data.teachPlanTreeNodes || this.teachPlanList;\r\n            const index = children.findIndex(d => d.id === data.id);\r\n            if(index < children.length-1){\r\n                const tree1 = children[index]\r\n                const tree2 = children[index+1]\r\n                this.$set(children,index,tree2)\r\n                this.$set(children,index+1,tree1)   \r\n                this.teachPlanList = JSON.parse(JSON.stringify(this.teachPlanList))\r\n                this.expandList[0] = data.parentid\r\n                _axios.put(\"/teachplan/down\",data)\r\n            }else{\r\n                this.$message('已无法下移');\r\n            }\r\n        },\r\n        getCourse(){\r\n            _axios.get(\"/course/\"+this.courseId).then(resp => {\r\n                this.courseBaseInfo =  resp.data.data\r\n                this.coverUrl = this.courseBaseInfo.coverUrl\r\n            })\r\n        },\r\n        next(courseBaseInfo) {\r\n            this.$refs[courseBaseInfo].validate((valid) => {\r\n                if (valid) {\r\n                    this.courseBaseInfo.coverUrl = this.coverUrl\r\n                    _axios.put(\"/course/add\", this.courseBaseInfo).then(resp => {\r\n                        if (resp.data.code == 1) {\r\n                            this.courseBaseInfo = resp.data.data\r\n                            if (this.active++ > 3) this.active = 0;\r\n                            this.getTeachPlanList()\r\n                            this.getCourseTimeList()\r\n                        }else{\r\n                            this.$message.error(resp.data.msg);\r\n                        }\r\n                    })\r\n                }else {\r\n                    this.$message.error('表单验证失败');\r\n                    return false;\r\n                }\r\n            })\r\n        },\r\n    },\r\n    mounted() {\r\n        if(this.$route.params.cid != 0 ){\r\n            this.courseId = this.$route.params.cid\r\n            this.getCourse()\r\n        }\r\n        \r\n    },\r\n    beforeDestroy() {\r\n        if (this.coverUrl) {\r\n            this.removeCoverUrl(null, null);\r\n        }\r\n    }\r\n}\r\nexport default options;\r\n</script>\r\n<style>\r\n.el-button--medium {\r\n    float: right;\r\n}\r\n\r\n.el-tree-node__children .el-tree-node{\r\n    height: 80px;\r\n}\r\n\r\n.workspace .el-textarea textarea{\r\n    resize: none;\r\n}\r\n.workspace .el-form-item__label{\r\n    text-align: center;\r\n}\r\n.workspace .el-step__title.is-process{\r\n    color: #003153;\r\n}\r\n/* .workspace .el-step__title.is-finish {\r\n    color: #441752;\r\n}\r\n */\r\n\r\n .avatar-uploader .el-upload {\r\n    border: 1px dashed #7ba57b;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n.step-body .outline .tree-node .operate .media-file[data-v-b4e21218] {\r\n    float: left;\r\n    margin-left: 10px;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n    border-color: #409EFF;\r\n }\r\n .outline .el-tree-node__content{\r\n    height: 60px;\r\n}\r\n.el-tree-node__content>.el-tree-node__expand-icon{\r\n    /* display: none; */\r\n}\r\n.step-body .outline .tree-node.ischild[data-v-b4e21218] {\r\n    border-left: 1px solid #cacaca;\r\n    padding-top: 25px;\r\n    /* margin-bottom: 25px; */\r\n    height: 80px;\r\n    line-height: 80px;\r\n}\r\n.step-body .outline .tree-node[data-v-b4e21218] {\r\n    height: 50px;\r\n    line-height: 50px;\r\n    width: 100%;\r\n}\r\n.step-body .outline .tree-node .operate[data-v-b4e21218] {\r\n    position: relative;\r\n    float: left;\r\n    padding-left: 10px;\r\n    background-color: #f1f1f1;\r\n    width: 1093px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .tree-node .operate .title[data-v-b4e21218] {\r\n    float: left;\r\n    padding-right: 10px;\r\n    width: 400px;\r\n    overflow: hidden;\r\n}\r\n.step-body .outline .tree-node .operate .buttons[data-v-b4e21218] {\r\n    position: absolute;\r\n    top: 0px;\r\n    right: 10px;\r\n    text-align: right;\r\n    width: 300px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .ischild .icon[data-v-b4e21218] {\r\n    display: block;\r\n    float: left;\r\n    width: 34px;\r\n    height: 25px;\r\n    border-bottom: 1px solid #cacaca;\r\n}\r\n.step-body .outline .tree-node[data-v-b4e21218] {\r\n    height: 50px;\r\n    line-height: 50px;\r\n    width: 100%;\r\n}\r\n.step-body .outline .ischild.tree-node .operate[data-v-b4e21218] {\r\n    width: 1040px;\r\n}\r\n\r\n.step-body .outline .tree-node .operate[data-v-b4e21218] {\r\n    position: relative;\r\n    float: left;\r\n    padding-left: 10px;\r\n    background-color: #f1f1f1;\r\n    width: 1093px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n.step-body .outline .ischild .operate .title[data-v-b4e21218] {\r\n    width: 300px;\r\n}\r\n\r\n\r\n\r\n</style>\r\n<style scoped>\r\n\r\n.dataList[data-v-38e7a12e] {\r\n    margin-top: 16px;\r\n}\r\n\r\n\r\n.avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 178px;\r\n    height: 178px;\r\n    line-height: 178px;\r\n    text-align: center;\r\n}\r\n.avatar {\r\n    width: 178px;\r\n    height: 178px;\r\n    display: block;\r\n}\r\n.avatar-uploader-icon[data-v-1affb897]{\r\n    background-color: #eaeddf;\r\n}\r\n\r\n\r\n.workspace {\r\n    margin-top: 16px;\r\n    width: 1200px;\r\n    min-height: 550px;\r\n    padding: 32px;\r\n    background-color: #e7f2eea4;\r\n}\r\n.workspace .primary-title {\r\n    height: 33px;\r\n    font-size: 24px;\r\n    font-family: PingFangSC-Medium, PingFang SC;\r\n    font-weight: 500;\r\n    color: #003153;\r\n    line-height: 33px;\r\n}\r\n.steps[data-v-1b10f526] {\r\n    padding: 20px;\r\n}\r\n.steps .nav[data-v-1b10f526] {\r\n    padding-bottom: 20px;\r\n}\r\n.steps .body[data-v-1b10f526] {\r\n    padding: 30px 0px 50px 0px;\r\n}\r\n.step-body[data-v-2411f0f0] {\r\n    width: 800px;\r\n    margin: 0px auto;\r\n}\r\n.steps .footer[data-v-1b10f526] {\r\n    padding: 20px 0px 20px 0px;\r\n    border-top: 1px solid #848ea0;\r\n    text-align: center;\r\n}\r\n.step-body .bar .title[data-v-b4e21218] {\r\n    display: inline-block;\r\n    width: 100px;\r\n    height: 22px;\r\n    font-size: 16px;\r\n    font-family: PingFangSC-Regular, PingFang SC;\r\n    font-weight: 400;\r\n    color: #003153;\r\n    line-height: 22px;\r\n}\r\n.step-body .outline[data-v-b4e21218] {\r\n    padding-top: 20px;\r\n    padding-bottom: 20px;\r\n    width: 1100px;\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}